function getPos(e){for(var a=0,r=0;null!=e;a+=e.offsetLeft,r+=e.offsetTop,e=e.offsetParent);return{x:a,y:r}}!function(e){e.fn.kitkatclock=function(a){return this.each(function(){var r={aliceblue:"rgba(240,248,255,1)",antiquewhite:"rgba(250,235,215,1)",aqua:"rgba(0,255,255,1)",aquamarine:"rgba(127,255,212,1)",azure:"rgba(240,255,255,1)",beige:"rgba(245,245,220,1)",bisque:"rgba(255,228,196,1)",black:"rgba(0,0,0,1)",blanchedalmond:"rgba(255,235,205,1)",blue:"rgba(0,0,255,1)",blueviolet:"rgba(138,43,226,1)",brown:"rgba(165,42,42,1)",burlywood:"rgba(222,184,135,1)",cadetblue:"rgba(95,158,160,1)",chartreuse:"rgba(127,255,0,1)",chocolate:"rgba(210,105,30,1)",coral:"rgba(255,127,80,1)",cornflowerblue:"rgba(100,149,237,1)",cornsilk:"rgba(255,248,220,1)",crimson:"rgba(220,20,60,1)",cyan:"rgba(0,255,255,1)",darkblue:"rgba(0,0,139,1)",darkcyan:"rgba(0,139,139,1)",darkgoldenrod:"rgba(184,134,11,1)",darkgray:"rgba(169,169,169,1)",darkgreen:"rgba(0,100,0,1)",darkkhaki:"rgba(189,183,107,1)",darkmagenta:"rgba(139,0,139,1)",darkolivegreen:"rgba(85,107,47,1)",darkorange:"rgba(255,140,0,1)",darkorchid:"rgba(153,50,204,1)",darkred:"rgba(139,0,0,1)",darksalmon:"rgba(233,150,122,1)",darkseagreen:"rgba(143,188,143,1)",darkslateblue:"rgba(72,61,139,1)",darkslategray:"rgba(47,79,79,1)",darkturquoise:"rgba(0,206,209,1)",darkviolet:"rgba(148,0,211,1)",deeppink:"rgba(255,20,147,1)",deepskyblue:"rgba(0,191,255,1)",dimgray:"rgba(105,105,105,1)",dodgerblue:"rgba(30,144,255,1)",firebrick:"rgba(178,34,34,1)",floralwhite:"rgba(255,250,240,1)",forestgreen:"rgba(34,139,34,1)",fuchsia:"rgba(255,0,255,1)",gainsboro:"rgba(220,220,220,1)",ghostwhite:"rgba(248,248,255,1)",gold:"rgba(255,215,0,1)",goldenrod:"rgba(218,165,32,1)",gray:"rgba(128,128,128,1)",green:"rgba(0,128,0,1)",greenyellow:"rgba(173,255,47,1)",honeydew:"rgba(240,255,240,1)",hotpink:"rgba(255,105,180,1)",indianred:"rgba(205,92,92,1)",indigo:"rgba(75,0,130,1)",ivory:"rgba(255,255,240,1)",khaki:"rgba(240,230,140,1)",lavender:"rgba(230,230,250,1)",lavenderblush:"rgba(255,240,245,1)",lawngreen:"rgba(124,252,0,1)",lemonchiffon:"rgba(255,250,205,1)",lightblue:"rgba(173,216,230,1)",lightcoral:"rgba(240,128,128,1)",lightcyan:"rgba(224,255,255,1)",lightgoldenrodyellow:"rgba(250,250,210,1)",lightgray:"rgba(211,211,211,1)",lightgreen:"rgba(144,238,144,1)",lightpink:"rgba(255,182,193,1)",lightsalmon:"rgba(255,160,122,1)",lightseagreen:"rgba(32,178,170,1)",lightskyblue:"rgba(135,206,250,1)",lightslategray:"rgba(119,136,153,1)",lightsteelblue:"rgba(176,196,222,1)",lightyellow:"rgba(255,255,224,1)",lime:"rgba(0,255,0,1)",limegreen:"rgba(50,205,50,1)",linen:"rgba(250,240,230,1)",magenta:"rgba(255,0,255,1)",maroon:"rgba(128,0,0,1)",mediumaquamarine:"rgba(102,205,170,1)",mediumblue:"rgba(0,0,205,1)",mediumorchid:"rgba(186,85,211,1)",mediumpurple:"rgba(147,112,219,1)",mediumseagreen:"rgba(60,179,113,1)",mediumslateblue:"rgba(123,104,238,1)",mediumspringgreen:"rgba(0,250,154,1)",mediumturquoise:"rgba(72,209,204,1)",mediumvioletred:"rgba(199,21,133,1)",midnightblue:"rgba(25,25,112,1)",mintcream:"rgba(245,255,250,1)",mistyrose:"rgba(255,228,225,1)",moccasin:"rgba(255,228,181,1)",navajowhite:"rgba(255,222,173,1)",navy:"rgba(0,0,128,1)",oldlace:"rgba(253,245,230,1)",olive:"rgba(128,128,0,1)",olivedrab:"rgba(107,142,35,1)",orange:"rgba(255,165,0,1)",orangered:"rgba(255,69,0,1)",orchid:"rgba(218,112,214,1)",palegoldenrod:"rgba(238,232,170,1)",palegreen:"rgba(152,251,152,1)",paleturquoise:"rgba(175,238,238,1)",palevioletred:"rgba(219,112,147,1)",papayawhip:"rgba(255,239,213,1)",peachpuff:"rgba(255,218,185,1)",peru:"rgba(205,133,63,1)",pink:"rgba(255,192,203,1)",plum:"rgba(221,160,221,1)",powderblue:"rgba(176,224,230,1)",purple:"rgba(128,0,128,1)",red:"rgba(255,0,0,1)",rosybrown:"rgba(188,143,143,1)",royalblue:"rgba(65,105,225,1)",saddlebrown:"rgba(139,69,19,1)",salmon:"rgba(250,128,114,1)",sandybrown:"rgba(244,164,96,1)",seagreen:"rgba(46,139,87,1)",seashell:"rgba(255,245,238,1)",sienna:"rgba(160,82,45,1)",silver:"rgba(192,192,192,1)",skyblue:"rgba(135,206,235,1)",slateblue:"rgba(106,90,205,1)",slategray:"rgba(112,128,144,1)",snow:"rgba(255,250,250,1)",springgreen:"rgba(0,255,127,1)",steelblue:"rgba(70,130,180,1)",tan:"rgba(210,180,140,1)",teal:"rgba(0,128,128,1)",thistle:"rgba(216,191,216,1)",tomato:"rgba(255,99,71,1)",turquoise:"rgba(64,224,208,1)",violet:"rgba(238,130,238,1)",wheat:"rgba(245,222,179,1)",white:"rgba(255,255,255,1)",whitesmoke:"rgba(245,245,245,1)",yellow:"rgba(255,255,0,1)",yellowgreen:"rgba(154,205,50,1)"};function t(e){if(null==e)return null;if(-1!=(e=e.replace("#","").replace(/grey/i,"gray")).indexOf("rgb"))return-1!=e.indexOf("rgba")?e:(rgb=e.split("(")[1].split(")")[0],"rgba("+rgb+",1)");if(r[e.toLowerCase()])return r[e.toLowerCase()];if(3==e.length){var a=e.substring(0,1),t=e.substring(1,2),o=e.substring(2,3);a+=a,t+=t,o+=o}else a=e.substring(0,2),t=e.substring(2,4),o=e.substring(4,6);return"rgba("+parseInt(a,16)+","+parseInt(t,16)+","+parseInt(o,16)+",1)"}var o=(a=a||{}).size||350;"number"!=typeof o&&(o=o.indexOf("pt")?parseFloat(o)*(4/3):parseFloat(o)),o-=26;var n=a.fontSize||40;"number"!=typeof n&&(n=n.indexOf("pt")?parseFloat(n)*(4/3):parseFloat(n));var i,l,g,s=a.fontFamily||"Verdana, sans-serif",c=a.colors||{};for(var b in c.text=c.text||"#FFFFFF",c.clock=c.clock||"#050505",c.numerals=c.numerals||c.text,c.hand=c.hand||"#960000",c.background=c.background||"#222222",c.meridian_background_on=c.meridian_background_on||c.hand,c.meridian_background_off=c.meridian_background_off||null,c.meridian_text=c.meridian_text||c.text,c.top_indicator_selected=c.top_indicator_selected||c.hand,c.top_indicator_deselected=c.top_indicator_deselected||c.text,c.top_indicator_background=c.top_indicator_background||c.clock,c.border=c.border||"#CCCCCC",c)c[b]=t(c[b]);c.meridian_background_off||(c.meridian_background_off=(i=c.meridian_background_on,l=c.background,g=.6,l=l.replace(/rgba|\(|\)/g,""),i=i.replace(/rgba|\(|\)/g,""),l=l.split(","),i=i.split(","),"rgba("+Math.round((1-g)*parseInt(l[0])+parseInt(i[0])*g)+","+Math.round((1-g)*parseInt(l[1])+parseInt(i[1])*g)+","+Math.round((1-g)*parseInt(l[2])+parseInt(i[2])*g)+",1)"));var d,u,p,h,f,m,k,v,y,w,_=10,x=o/2,M=Math.PI,C=!1,I=!0,S=!0,F=e("<div>").hide(),A=e(this).on("mouseup",function(){if(e(this).is(":focus")){e(this).trigger("blur");var a=A.val().split(":"),r=parseInt(a[0]),t=parseInt(a[1]);F.attr({hour:12==r?0:r,minute:t}),h.html((r<10?"&nbsp;":"")+r),f.html((t<10?"0":"")+t),I=!0,q(),F.show();for(var o=A.offset(),n=e(window).width(),i=(e(window).height(),e(document).width()),l=(e(document).height(),F.outerWidth()),g=(F.outerHeight(),{top:getPos(document.getElementsByClassName("pickUpTime")[0]).y+45,left:o.left}),s={top:e("body").scrollTop(),left:e("body").scrollLeft()},c=s.left,b=s.left+n;g.left+l>i&&g.left>0;)g.left-=1;if(l<=n){for(;g.left<c;)g.left++;for(;g.left+l>b;)g.left--}else g.left=c-(l-n)/2;F.css({position:"absolute",top:g.top,left:g.left});var d=h.html();h.html("12");var u={top:f.height()+f.position().top-w.height()-5,left:f.width()+f.position().left};w.css({position:"absolute",top:u.top,left:u.left}),h.html(d),e("body").on("click",function(a){var r=a.target;e(r).is(F)||0!=F.has(r).length||e(r).is(A)||T()}),e("*",F).css("textShadow","none")}});function P(e,a){var r=e.getContext("2d");r.fillStyle=a,r.clearRect(0,0,2*n,2*n),r.arc(n/2,n/2,n/2,0,2*M),r.fill()}function T(){A.val(h.html().replace("&nbsp;","")+":"+f.html()+" "+(y[0].checked?"AM":"PM")),F.hide()}function q(){h.css("color",c.top_indicator_selected),f.css("color","");var e=p[0].getContext("2d");e.clearRect(0,0,o,o),e.fillStyle=c.numerals,e.font=n+"px "+s,e.textBaseline="middle",e.textAlign="center";for(var a=Math.PI,r=a/2,t=0;t<12;t++){var i=x+-1*Math.cos(r)*(x-n/1.75),l=x+-1*Math.sin(r)*(x-n/1.75);e.fillText(0==t?12:t,i,l),r+=a/6}null!=F.attr("hour")?E(a/2+parseInt(F.attr("hour"))*(a/6)):E(a/2)}function z(){f.css("color",c.top_indicator_selected),h.css("color","");var e=p[0].getContext("2d");e.clearRect(0,0,o,o),e.fillStyle=c.numerals,e.font=n+"px "+s,e.textBaseline="middle",e.textAlign="center";for(var a=M/2,r=0;r<12;r++){var t=x+-1*Math.cos(a)*(x-n/1.5),i=x+-1*Math.sin(a)*(x-n/1.5);e.fillText(5*r,t,i),a+=M/6}if(null!=F.attr("minute")){var l=parseInt(F.attr("minute"));E(M/2+l*(M/30))}else E(M/2)}function E(e){u.css({"-webkit-transform":"rotate("+180*e/M+"deg)"})}!function(){e("body").append(F),""==A.val()&&A.val("10:30 AM"),d=e("<canvas>"),u=e("<canvas>"),p=e("<canvas>"),y=e("<input type='checkbox'>").on("change",function(){this.checked?(P(k[0],c.meridian_background_on),P(v[0],c.meridian_background_off),w.html("AM")):(P(v[0],c.meridian_background_on),P(k[0],c.meridian_background_off),w.html("PM"))}).hide(),k=e("<canvas>"),v=e("<canvas>");var a=e("<div>AM</div>").css({position:"absolute",top:10+o,left:_,width:n,height:n,textAlign:"center",lineHeight:n+"px",fontSize:n/2,fontFamily:s,cursor:"pointer"}).on("click",function(){k.trigger("click")}),r=e("<div>PM</div>").css({position:"absolute",top:10+o,right:_,width:n,height:n,textAlign:"center",lineHeight:n+"px",fontSize:n/2,fontFamily:s,cursor:"pointer"}).on("click",function(){v.trigger("click")});w=e("<div class='amPmTop'>").css({color:c.top_indicator_deselected,display:"inline-block"}),e([k,v]).each(function(){this.attr({height:n,width:n}).on("click",function(){y[0].checked=e(this).is(k),y.trigger("change")}).css({position:"absolute",top:o+10}),this==k?this.css("left",_):this.css("right",_),P(this[0],c.meridian_background_on)}),-1!=A.val().toUpperCase().indexOf("AM")&&(y[0].checked=!0),y.trigger("change"),F.addClass("clockEdShow"),F.css({width:o,height:o+2*n+10,zIndex:9999999,backgroundColor:c.background,borderRadius:"0",padding:"3px "+_+"px",fontFamily:s,color:c.text}),m=e("<div class='canContEd'>").css({position:"absolute",top:n+10,left:_,width:o,height:o,cursor:"hand"}),e([d,u,p]).each(function(){this.attr({width:o,height:o}).css({position:"absolute",top:"3px",left:"0px"})}),h=e("<span>").html(12).on("click",function(){I=!0,q()}).css({fontSize:n,cursor:"pointer"}),f=e("<span>").html("00").on("click",function(){I=!1,z()}).css({fontSize:n,cursor:"pointer"});var t=e("<div class='timeTopEd'>");t.append(h).append(e("<span>:</span>").css("fontSize",n)).append(f).append(y).css({position:"absolute",top:7,left:0,width:"100%",textAlign:"center",background:c.top_indicator_background,color:c.top_indicator_deselected});var i=e("<div class='clockDone'>Done</div>").css({width:"100%",cursor:"pointer",textAlign:"center",fontSize:n*(2/3),position:"absolute",borderTop:"0px solid "+c.border,top:o+20+n,left:0}).on("click",T);m.append(d).append(u).append(p),F.append(m).append(t).append(i).append(k).append(v).append(a).append(r).append(w);var l=d[0].getContext("2d");l.arc(x,x,x,0,2*M),l.fillStyle=c.clock,l.fill(),q(),function(){var e=u[0].getContext("2d");e.clearRect(0,0,o,o);var a=x+-1*Math.cos(0)*(x-n/1.1),r=x+-1*Math.sin(0)*(x-n/1.1);e.beginPath(),e.moveTo(x,x),e.lineTo(a,r),e.strokeStyle=c.hand,e.lineWidth=2,e.stroke(),e.closePath(),e.arc(a,r,n*(1.4/1.5),0,3*M),e.fillStyle=c.hand,e.fill()}(),m.on("mousemove mousedown mouseup touchstart touchend touchcancel click touchmove",function(e){if(!(!S||e.offsetX>o||e.offsetY>o)){var a;if("touchmove"==e.type||"touchstart"==e.type){e.offsetX=e.originalEvent.touches[0].pageX,e.offsetY=e.originalEvent.touches[0].pageY;var r=m.offset();e.offsetX-=r.left,e.offsetY-=r.top}switch(e.type){case"touchmove":a="mousemove",e.preventDefault();break;case"touchend":case"touchcancel":a="mouseup";break;case"touchstart":a="mousedown";break;default:a=e.type}if("mousedown"==a&&(C=!0),"mouseup"==a&&(C=!1),"click"==a||"mousedown"==a||"mousemove"==a&&C){var t=function(e,a,r){e-=x,a-=x,r/=2;var t=Math.sqrt(e*e+a*a),o=Math.asin(a/t),n=M/r*Math.round(o/(M/r));n/=M,n*=r;var i=r/2;return e>0||(i*=3,n*=-1),i+n}(e.offsetX,e.offsetY,I?12:60);if(null==t)return;var n=M/2;if(I||(t>0&&t<=15&&(t=15),t>15&&t<=30&&(t=30),t>30&&t<=45&&(t=45),t>45&&(t=0)),E(n=(n+=t*M/(I?6:30))>2*M?n-2*M:n),I){F.attr("hour",t);var i=F.attr("minute")||0;i=parseInt(i);var l=t;i=60==(i=Math.round(i))?0:i,h.html((l<10&&0!=l?"&nbsp;":"")+(0==l?12:l)),f.html((i<10?"0":"")+i)}else F.attr("minute",t),l=F.attr("hour")||0,l=parseInt(l),i=t,i=60==(i=Math.round(i))?0:i,h.html((l<10&&0!=l?"&nbsp;":"")+(0==l?12:l)),f.html((i<10?"0":"")+i)}"mouseup"==a&&I&&(I=!1,z(),S=!1,setTimeout(function(){S=!0},100))}})}()})}}(jQuery);